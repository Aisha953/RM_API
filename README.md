# 基本信息
* 项目名称        :    RM机械臂API源码
* 当前版本        :    4.0.0
* 维护人           :    黄凯勋
---
# 项目结构
> RM_API 主项目
>
> > RM_API.pro

>> RM_Base 子项目 C语言 API

>>> cJSON.h
>>> cJSON.c
>>> rm_base_h
>>> rm_base.c
>>> rm_queue.h
>>> rm_queue.c
>>> RM_Base.pro
>>> rm_base_global.h
>>> rm_define.h

>> RM_Service 子项目 C++语言 API

>>> rm_service.h
>>> rm_service.cpp
>>> RM_Service.pro
>>> rm_service_global.h
---
# 更新记录
##### 更新时间: 2022-09-07
##### 更新内容:  
    1. Windows C/C++代码初次提交(未测试)。

###### 更新时间: 2022-09-08
###### 更新内容:
             1. 解决Linux跨平台线程编译问题。
             2. 调试正解逆解算法。

###### 更新时间: 2022-09-09
###### 更新内容:
             1. 新增 绕轴旋转接口
             2. 新增 末端位姿转工具位姿接口
             3. 新增 工具位姿转末端位姿接口
             4. 新增 四元数转欧拉角接口
             5. 新增 欧拉角转四元数接口
             6. 新增 欧拉角转旋转矩阵接口
             7. 新增 位姿转旋转矩阵接口
             8. 新增 旋转矩阵转位姿接口
             9. 新增 基坐标系转工作坐标系接口
            10. 新增 工作坐标系转基坐标系接口
            11. 修改 README文件格式

###### 更新时间: 2022-09-19
###### 更新内容:
<<<<<<< HEAD
			 1. 新增机械臂型号宏定义
			 2. 修复63/65算法接口返回0错误。
			 3. 修改回调函数非必填。
			 4. 修复透传接口传参。

###### 更新时间: 2022-09-20
###### 更新内容:		
             1. 修改运动函数超时时间策略
             2. 修改超时时间为固定3秒 
             3. 修改Linux透传接口回传数据错误。
             4. 新增回调接口判断指令类型。
=======
             1. 修改回调函数为非必填项。
             2. 新增安装角度z轴。
             3. 新增算法数据初始化函数。
             4. 删除硬件版本号接口。
             5. 修改透传接口数据回传逻辑
             
###### 更新时间: 2022-09-20
###### 更新内容:
             1. 修改运动类型接口超时时间触发逻辑。
             2. 修改超时时间为固定3秒。
             3. 修改Linux透传接口回传数据错误。
             4. 新增回调接口判断指令类型。

###### 更新时间: 2022-09-21
###### 更新内容:
             1. 修改头文件错误返回描述,原先固定返回1 现在返回指定错误码
             2. 删除调试日志

###### 更新时间: 2022-09-29
###### 更新内容:
             1. 修改回调函数参数格式。
             2. 修复力位混合控制接口无法调用问题。
             3. 增加轨迹文件下发接口。

###### 更新时间: 2022-10-09
###### 更新内容:
             1. 新增轨迹文件下发接口。
             2. 修改力位混合控制接口小数保留位
             3. 新增BLOCK宏定义

###### 更新时间: 2022-11-01
###### 更新内容:
		     1. 新增文件下发接口。
		     2. 修复透传力位混合补偿接口小数位保留位数问题。
		     3. 新增数字标识改为宏定义。
		     4. 修复RotateMove 接口参数注释不全。
		     5. 新增RotateMove联合运动接口。
		     6. 修复运动类型接口超时逻辑发现有异常超时情况。
		     7. 新增API力控代码流程，如力位混合控制、力位混合透传补偿等。
		     8. 新增在线编程文件下发示例，和执行过程中的查询。
		     9. 修复设置限位不成功问题。
	        10. 修复机械臂标定接口超时返回问题。
	        11. 修复力数据返回整数问题。
	        12. 修复Set_Force_Postion 异常超时返回问题。
	        13. 修复Force_position_State接口增加错误码返回值。
	        14. 新增判断队列是否满的状态，防止超过队列最大限制。
	        15. 新增示教运动指定坐标系。
	        16. 新增轨迹运动指定坐标系。
	        17. 修改设置modbus工作模式后强制休眠两秒。
	        18. 修改正解逆解算法, 统一参数与颖总代码一致。
	        19. 补全透传接口回调函数返回值。
	        20. 新增初始化API时自动获取机械臂工具坐标和工作坐标。
	        21. 修复Set_Tool_DO_State 接口异常超时问题。
	        22. 修复Stop_Force_Postion_Move接口异常超时问题。
	        23. 修改Set_High_Speed_Eth接口调用后强制休眠1秒。
	        24. 修改Auto_Set_Fz异常超时问题。
	        25. 修改逆解函数头文件注释不全问题。
	        26. 删除Set_PWM接口。
	        27. 修复设置算法末端DH参数无效问题。

###### 更新时间: 2023-04-07
###### 更新人：Jackson
###### 更新内容:
            1. 去掉函数Forward_Kinematics中无用的打印信息;
            2. 变更版本号为4.1.5。

###### 更新时间: 2023-04-20
###### 更新人：Jackson
###### 更新内容:
            1. 解决因中间层调用引起的系列问题；
            2. 修正部分数据结构; 
            3. 修正部分函数名称；
            4. 去除无用的printf；
            5. 变更版本号为4.1.6。

###### 更新时间: 2023-04-23
###### 更新人：Jackson
###### 更新内容:   
            1. 更新部分API处理逻辑，删除无用的接口; 

###### 更新时间: 2023-05-18
###### 更新人：Jackson
###### 更新内容:  
            1. 修正函数名称拼写错误问题; 
            2. 同步修正接口相关的注释。

###### 更新时间: 2023-06-17
###### 更新人：Jackson
###### 更新内容:          
            1. 完善API相关接口（包括命名、注释、参数、逻辑实现等）；
            2. 修正算法方面接口（改为引用算法库，同步修改相关引用和实现）；
            3. 增加读多圈、读多个保存寄存器的功能接口。
            4. 修复以下BUG：
            5. 拖动示教复现过程暂停后，发送拖动示教轨迹复现继续指令，API结果返回1，继续失败; 
            6. API发送movec指令，返回值为14;
            7. 工作坐标系和工具坐标系切换后，API发送末端位姿转换成工具位姿及工具位姿转换成末端位姿失败，依旧是未转换之前的位姿;
            8. 拖动示教后，发送运动到轨迹起点指令，API结果返回7，socket超时; 
            9. 六点发自动设置工具坐标系，末端负载位置单位错误; 
            10. 算法API设置安装角度、工具或工作坐标后，进行正解、逆解、计算环绕运动位姿、计算沿工具坐标系运动位姿操作，安装角度，工具或工作坐标系数据重置; 
            11. 发送手动添加工作坐标系，返回值为7; 
            12. 发送文件下发指令，返回结果为7; 
            13. 关闭力位混合补偿模式，结果返回7; 
            14. 获取安装角度，API返回值为-1; 
            15. 读取多个寄存器，返回值为7;
            16. 发送轨迹规划中改变速度比例系数指令，结果返回9；
            17. 停止力位混合控制补偿模式接口函数名书写错误；
            18. 算法中获取安装角度，获取工作坐标系和工具坐标系内容返回是矩阵；
            19. 设置算法的安装角度失败，安装角度依旧为默认的安装角度；
            20. 切换示教器运动坐标系中block类型为int型；
            21. 算法设置工作坐标系时后，通过获取工作坐标系返回的数据和设置的工作坐标系数据不一致；
            22. 算法设置最大最小限位及最大速度和最大加速度失败，获取到的数据依旧为默认数据；
            23. 置关节碰撞等级，返回值为7；
            24. I获取所有状态时，返回的关节当前角度为0；
            25. 开启力位混合控制后调用movel，偶发movel返回14；
            26. Set_Force_Postion接口返回7；
            27. 使用了非默认的工作坐标系，再次打开示教器时，会自动下发切换到默认坐标系，导致坐标系发生变化；
            28. Drag_Trajectory_Origin\Run_Drag_Trajectory返回7；
            29. 使用WiFi-sta模式，在Linux系统下调用获取机械臂状态偶发超时；
            30. API中添加读多个保存寄存器的接口；
            31. 透传力位混合控制补偿，回调函数增加返回6个方向力的数据。

###### 更新时间: 2023-06-19
###### 更新人：Jackson
###### 更新内容:
            1. 修改arm库的引用方式；
            2. 出4.2.0版本。

###### 更新时间: 2023-06-19
###### 更新人：Jackson
###### 更新内容:
            1. 修正movej过程中控制夹爪返回失败的问题；
            2. 修改头文件的引用位置。

###### 更新时间: 2023-06-21
###### 更新人：Jackson
###### 更新内容:
            1. 添加Windows下x86(32位)编译选项；
            2. 其它语法修正。

###### 更新时间: 2023-07-04
###### 更新人：Jackson
###### 更新内容:
            1. 修正获取有线网卡信息和无线网卡信息接口（去掉网关数据）；
            2. IO接口调整；
            3. 写单圈数据、写单个寄存器接口更正；
            4. 升级版本至4.2.1；
            5. 其它细节完善。

###### 更新时间: 2023-07-06
###### 更新人：Jackson
###### 更新内容:
            1. 修正Get_IO_State接口及实现逻辑；
            2. 完善头文件相关注释；
            3. 全面整理指令返回解析函数，修正其逻辑错误。

>>>>>>> taimi

###### 更新时间: 2023-08-21

###### 更新人：Aisha

###### 更新内容:

            1. 新增适配第三代控制器接口；
            2. 新增UDP机械臂状态主动上报接口；
            3. 新增扩展关节、保存拖动示教轨迹接口；
            4. 修复Set_IO_State\Set_Net_Default返回值错误的问题；
            5. get_IO_input 适配I系列，修改DI数据类型为int数组。

###### 更新时间: 2023-10-31

###### 更新人：Aisha

###### 更新内容:

            1. 修复Get_Program_Run_State未运行程序和运行没有存储程序返回id都为0的问题
            2. 修复Get_Realtime_Push获取标准版机械臂力数据坐标系时返回错误的问题
            3. 修复Set_Realtime_Push设置标准版机械臂力数据坐标系失败的问题
            4. 重构带有结构体指针的C++接口为共享指针，以适配MATLAB API
            5. 文档以及头文件注释勘误
            6. 弃用Set_IO_State接口
            7. 修复七轴机械臂调用手动设置六维力重心接口报错问题
            8. 增加在线编程列表相关4个接口，新增获取当前规划类型新增轨迹复现类型，新增设置实时状态推送接口
            9. get_wifi_net返回结构体并新增wifi名称、密码、信道
            10. 新增查询控制器RS485模式、查询工具端RS485模式接口
            11. 修复返回指定工作、工具坐标系找不到时返回false
            12. 修复拖动示教轨迹复现阻塞模式时间长返回超时问题
            13. 重构Service_Get_Program_Trajectory_List接口，修复Matlab API无法设置
            'vague_search' 属性的问题

###### 更新时间: 2023-12-29

###### 更新人：Aisha

###### 更新内容:

            1.新增设置关节（驱动器）最大转速，最大加速度，最大、最小限位
            2.新增查询关节（驱动器）最大转速，最大加速度，最大、最小限位
            3.新增自动设置关节限位Auto_Set_Joint_Limit
            4.新增超出限位后，自动运动到限位内（不对外开放）Auto_Fix_Joint_Over_Soft_Limit
            5.新增获取示教参考坐标系Get_Teach_Frame
            6.新增连接/断开ModbusTCP从站
                (1)Set_Modbustcp_Mode
                (2)Close_Modbustcp_Mode
            7.新增读取机械臂软件信息Get_Arm_Software_Info
            8.新增设置/获取机械臂模式(仿真/真实)
                (1)Set_Arm_Run_Mode
                (2)Get_Arm_Run_Mode
            9.查询在线编程运行状态（新增参数）Get_Program_Run_State
                (1)step_mode：单步模式，1为单步模式，0为非单步模式
                (2)plan_speed：全局规划速度比例 1-100
            10.新增查询夹爪状态接口
            11.MoveJ：关节运动（新增参数）
                (1)trajectory_connect：代表是否和下一条运动一起规划，0代表立即规划，1代表和下一条轨迹一起规划，当为1时，轨迹不会立即执行
            12.MoveJ、moveL、moveC、moveJ_P、MoveRotate_Cmd、MoveCartesianTool_Cmd新增参数同Movej
            13.开始复合模式拖动示教（新增参数）
                (1)singular_wall：仅在六维力模式拖动示教中生效，用于指定是否开启拖动奇异墙，0表示关闭拖动奇异墙，1表示开启拖动奇异墙，若无配置参数，默认启动拖动奇异墙
            14.新增电子围栏相关接口
                (1)设置电子围栏使能状态
                (2)获取电子围栏使能状态
                (3)设置当前电子围栏参数
                (4)获取当前电子围栏参数
                (5)增加电子围栏（最多支持十个电子围栏）
                (6)更新电子围栏（最多支持十个电子围栏）
                (7)删除电子围栏（最多支持十个电子围栏）
                (8)获取电子围栏列表名称（最多支持十个电子围栏）
                (9)获取指定电子围栏参数（最多支持十个电子围栏）
                (10)获取电子围栏参数列表（最多支持十个电子围栏）
            15.新增自碰撞接口
                (1)设置自碰撞安全检测使能状态
                (2)获取自碰撞安全检测使能状态
            16.修复已知问题
                (1)修复Stop_Force_Postion非阻塞模式不生效
                (2)修复udp推送数据四元数参数顺序错误问题
                (3)修复多次调用连接断开接口程序崩溃问题
                (4)修复Python API透传力位混合补偿-位姿，力控不生效问题

###### 更新时间: 2024-1-30

###### 更新人：Aisha

###### 版本：4.2.9

###### 更新内容:

    		1、连接函数中Sokcet 数据绑定时，查询为空的数据结构进行绑定，修改最大同时连接数为20。
    		2、连接时发生失败调用Arm_Socket_Close关闭套接字再返回
    		3、关闭套接字时同步修改对应的Sokcet 数据绑定数据结构以及记录socket结构体长度的变量
    		4、查询连接状态修改为发送json协议并收到机械臂回复认为连接成功，原来为发送成功即连接成功，对拔掉网线等异常断开不能及时察觉
    		5、修复重复连接断开机械臂300次之后连接失败的问题

###### 更新时间: 2024-4-3

###### 更新人：Aisha

###### 版本：4.3.0

###### 更新内容:

            1、适配GEN72、ECO63机械臂
            2、运动接口优化，适配1.5.0版本控制器
            3、修复灵巧手相关阻塞模式不生效
            4、修复夹爪夹取松开速度低时执行成功返回7的问题，新增超时时间设置
            5、修复Set_Joint_Drive_Acc设置成功返回7
            6、修改管理电子围栏等接口名称为管理几何参数模型，单位由mm改为m，修改ElectronicFenceConfig结构体
            7、修改SensorType枚举项名称B、ZF、SF为_B、_ZF、_SF
            8、优化电子围栏与虚拟墙数据管理接口 
            9、新增工作坐标系和工具坐标系的更新接口 
            10、新增工具坐标系包络参数相关接口 
            11、新增虚拟墙相关接口 
            12、新增在线编程文件信息修改接口 
            13、新增 IO 控制默认运行在线编程文件接口 
            14、新增全局点位相关接口 
            15、修复matlab API旋转矩阵相关的算法接口无法完全打印的问题

###### 更新时间: 2024-5-27

###### 更新人：Aisha

###### 版本：4.3.1

###### 更新内容:

            1、新增样条曲线运动、读多个输入寄存器
            2、角度透传扩展关节由int修改为float
            3、修复eco65正解结果错误问题，连接时获取版本信息Get_Arm_Software_Version改为Get_Arm_Software_Info
            4、Get_Current_Trajectory新增样条曲线运动类型
            5、Set_Program_ID_Start修复阻塞模式程序崩溃

###### 更新时间: 2024-7-9

###### 更新人：Aisha

###### 版本：4.3.2

###### 更新内容:

            1、适配GEN72型号
            2、算法库版本升级到1.3.9
            3、新增算法库版本号查询

###### 更新时间: 2024-8-5

###### 更新人：Aisha

###### 版本：4.3.3

###### 更新内容:

            1、适配控制器1.6.0版本，修复UDP接口无法读取的问题
            2、python透传接口删除打印日志，打印数据会导致周期延长
            3、修复逆解四元数表示姿态时非法输入的问题
            4、python包无需更换c库，可直接在各环境中使用
    		5、python包支持pip安装
    		6、新增交融半径功能
    		7、修复提供的demo中的几处问题
    		8、更新python版本要求3.10

